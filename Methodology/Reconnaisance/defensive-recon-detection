# Defensive Reconnaissance Detection â€“ Thought Process

Detecting reconnaissance as a single, broad phase across an environment is inherently difficult. Attackers often distribute their activity by changing source IPs, introducing time gaps between requests, or blending reconnaissance traffic with legitimate user behavior. Attempting to detect reconnaissance globally in such conditions can easily lead to excessive false positives.

Because of this, it makes more sense to focus on **targeted reconnaissance detection**, where attacker behavior becomes more intentional and distinguishable.

---

## Application-Centric Detection Strategy

In this lab, reconnaissance detection was focused on the web application layer. Web applications are commonly targeted during early attack stages, and tools such as **Gobuster** and fuzzing utilities are frequently used to enumerate hidden directories and endpoints.

Unlike normal user traffic, this activity generates a large number of requests in a short period of time and consistently triggers application errors.

---

## Observed Log Patterns

Analysis of the Apache logs revealed two clear indicators of reconnaissance activity:

- **Access Logs:**  
  A sudden spike in HTTP requests originating from a single client IP, with more than **1,400 requests** generated within a short time window. This request volume is not consistent with normal browsing behavior.
  ![Apache access logs](../../Images/apache_access_logs_gobuster.png)

- **Error Logs:**  
  Repeated PHP and application errors caused by requests for non-existent or restricted resources. These errors were produced as enumeration tools attempted to discover valid application endpoints.
  ![Apache error logs](../../Images/apache_error_logs_gobuster.png)

To further validate this behavior, access logs were aggregated by client IP and time interval. The resulting query highlighted abnormally high request rates per minute from a single source, clearly separating automated reconnaissance from legitimate user traffic. Shows around 1400 count, which should the abnormal traffic behaviour.
```bash
index=web sourcetype=apache:access earliest=-10m
| bin _time span=1m
| stats count as req_per_min by clientip, _time
| sort -req_per_min
```
![Query to Detect Web Recon](../../Images/apache_access_gobuster.png)

---

## Defensive Insight

This approach demonstrates that focusing on **application-specific reconnaissance** provides a clearer and more reliable detection signal than attempting to detect reconnaissance at a global level. High request volume combined with error-heavy behavior is intentional, automated activity and is unlikely to be generated by normal users.

By narrowing the detection scope to the target system itself, reconnaissance activity can be identified with greater confidence and minimal false positives, even when attackers attempt to evade broader network-based detection.
